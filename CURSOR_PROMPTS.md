# Cursor用 Raspberry Pi 5 サーバー構築プロンプト集

## メインプロンプト

```
Raspberry Pi 5でHTTP/2とHTTP/3の性能比較ベンチマーク用サーバーを構築してください。

## プロジェクトの目的
このプロジェクトは、HTTP/2とHTTP/3の性能比較ベンチマークを実機環境で実施するためのものです。

### 実験の目的
1. **HTTP/2 vs HTTP/3の性能比較**: 異なるネットワーク条件での性能測定
2. **実機環境での検証**: Docker環境と実機環境での性能差の測定
3. **ネットワークエミュレーション**: 遅延・パケットロス環境での性能評価
4. **自動化されたベンチマーク**: グラフ生成まで完全自動化

### 実験環境
- **クライアント側**: Docker環境（h2loadベンチマークツール）
- **サーバー側**: Raspberry Pi 5実機（Nginx HTTP/2/3対応）
- **ネットワーク**: 物理ネットワーク（無線LAN/有線LAN）
- **エミュレーション**: Dockerルーターでtc netemを使用

## 技術要件
- OS: Raspberry Pi OS (64-bit)
- Webサーバー: Nginx (HTTP/2 + HTTP/3対応)
- プロトコル: HTTP/2, HTTP/3 (QUIC)
- SSL/TLS: 自己署名証明書
- ネットワーク: 無線LAN (wlan0) または有線LAN (eth0)
- IPアドレス: 172.30.0.2/24
- ポート: 443 (HTTP/2とHTTP/3共用)

## 必要な機能
1. HTTP/2サーバー (ポート443)
2. HTTP/3サーバー (ポート443)
3. SSL/TLS暗号化
4. ヘルスチェックエンドポイント (/health)
5. エコーサービスエンドポイント (/echo)
6. システム監視機能
7. ログ機能

## 参考ドキュメント
- CURSOR_RASPBERRY_PI_SETUP.md を参照してください

## 出力形式
- 各ステップのコマンドを順番に提示
- エラーハンドリングを含む
- 動作確認方法も含める
- トラブルシューティング情報も提供

段階的に構築を進めてください。
```

## サブプロンプト

### 1. 初期セットアップ用プロンプト

```
Raspberry Pi 5の初期セットアップを行ってください。

## 作業内容
1. システム更新
2. 必要なパッケージのインストール
3. ネットワーク設定（固定IP）
4. 基本的なシステム設定

## パッケージリスト
- nginx, nginx-extras
- build-essential, cmake, pkg-config
- libssl-dev, libnghttp2-dev, libngtcp2-dev, libnghttp3-dev
- その他HTTP/3ビルドに必要なライブラリ

## ネットワーク設定
- 無線LAN (wlan0): 172.30.0.2/24
- 有線LAN (eth0): 172.30.0.2/24 (必要に応じて)
- ゲートウェイ: 172.30.0.254
- DNS: 8.8.8.8

各コマンドの説明とエラーハンドリングを含めてください。
```

### 2. Nginx HTTP/3ビルド用プロンプト

```
Raspberry Pi 5でNginx HTTP/3対応版をビルドしてください。

## 作業内容
1. Nginxソースダウンロード
2. 依存関係のインストール
3. ビルド設定（HTTP/3対応）
4. コンパイルとインストール

## ビルド要件
- HTTP/2サポート
- HTTP/3サポート (QUIC)
- SSL/TLSサポート
- パフォーマンス最適化

## 注意点
- メモリ使用量に注意
- ビルド時間の考慮
- エラー時の対処法

段階的にビルドを進めてください。
```

### 3. SSL証明書設定用プロンプト

```
Raspberry Pi 5でSSL証明書を設定してください。

## 作業内容
1. 証明書ディレクトリ作成
2. 自己署名証明書生成
3. 権限設定
4. 証明書検証

## 証明書要件
- 自己署名証明書（開発・テスト用）
- 有効期限: 365日
- 鍵長: 2048bit
- 証明書名: grpc-server-pi.local

## セキュリティ考慮
- 適切な権限設定
- 証明書の保護
- バックアップの作成

各ステップの詳細なコマンドを提示してください。
```

### 4. Nginx設定用プロンプト

```
Raspberry Pi 5でNginx設定を行ってください。

## 設定内容
1. ユーザーとディレクトリ作成
2. Nginx設定ファイル作成
3. HTTP/2とHTTP/3の設定
4. SSL/TLS設定
5. エンドポイント設定

## 設定要件
- HTTP/2サポート
- HTTP/3サポート (QUIC)
- SSL/TLS暗号化
- ヘルスチェック (/health)
- エコーサービス (/echo)
- パフォーマンス最適化

## 設定ファイル
- /etc/nginx/nginx.conf
- ログ設定
- セキュリティ設定

完全な設定ファイルの内容を提示してください。
```

### 5. システムサービス設定用プロンプト

```
Raspberry Pi 5でNginxのシステムサービスを設定してください。

## 作業内容
1. systemdサービスファイル作成
2. サービス有効化
3. 自動起動設定
4. サービス管理

## サービス要件
- システム起動時の自動開始
- プロセス管理
- ログ管理
- エラー時の再起動

## 設定ファイル
- /etc/systemd/system/nginx.service
- サービス設定
- 依存関係設定

systemdの設定とサービス管理方法を説明してください。
```

### 6. 監視・ログ設定用プロンプト

```
Raspberry Pi 5で監視・ログ機能を設定してください。

## 作業内容
1. 監視スクリプト作成
2. ログローテーション設定
3. システム監視設定
4. パフォーマンス監視

## 監視項目
- システムリソース (CPU, メモリ, ディスク)
- ネットワーク状態
- Nginxサービス状態
- 接続数

## ログ設定
- アクセスログ
- エラーログ
- ログローテーション
- ログ圧縮

監視スクリプトとログ設定の詳細を提示してください。
```

### 7. 動作確認用プロンプト

```
Raspberry Pi 5サーバーの動作確認を行ってください。

## 確認項目
1. サービス状態確認
2. ポート確認
3. HTTP/2接続テスト
4. HTTP/3接続テスト
5. SSL証明書確認
6. エンドポイント確認

## テスト方法
- ローカル接続テスト
- 外部接続テスト
- プロトコル確認
- パフォーマンス確認

## トラブルシューティング
- 接続エラーの対処
- 設定エラーの修正
- パフォーマンス問題の解決

各確認項目の詳細な手順を提示してください。
```

### 8. ファイアウォール設定用プロンプト

```
Raspberry Pi 5でファイアウォールを設定してください。

## 設定内容
1. UFWの有効化
2. 必要なポートの開放
3. セキュリティ設定
4. ルール確認

## 開放ポート
- 22/tcp (SSH)
- 80/tcp (HTTP)
- 443/tcp (HTTPS/HTTP2/HTTP3)

## セキュリティ考慮
- 最小権限の原則
- 不要なポートの閉鎖
- ログ記録

ファイアウォール設定の詳細な手順を提示してください。
```

### 9. パフォーマンス最適化用プロンプト

```
Raspberry Pi 5サーバーのパフォーマンスを最適化してください。

## 最適化項目
1. カーネルパラメータ調整
2. ネットワーク設定最適化
3. Nginx設定最適化
4. システム設定最適化

## 最適化対象
- TCP設定
- メモリ設定
- ファイルディスクリプタ制限
- ワーカープロセス数

## 監視項目
- リソース使用量
- ネットワーク性能
- 接続数
- レスポンス時間

パフォーマンス最適化の詳細な設定を提示してください。
```

### 10. トラブルシューティング用プロンプト

```
Raspberry Pi 5サーバーのトラブルシューティングを行ってください。

## よくある問題
1. 接続できない
2. SSL証明書エラー
3. HTTP/3が動作しない
4. パフォーマンス低下
5. サービスが起動しない

## 診断方法
- ログ確認
- ネットワーク確認
- 設定確認
- リソース確認

## 解決方法
- 設定修正
- サービス再起動
- 権限修正
- 依存関係確認

各問題の診断と解決方法を詳細に説明してください。
```

## 使用方法

1. **メインプロンプト**を使用して全体の構築を依頼
2. 必要に応じて**サブプロンプト**を使用して特定の作業を依頼
3. 各ステップで動作確認を行う
4. エラーが発生した場合は**トラブルシューティング用プロンプト**を使用

## 注意事項

- 各プロンプトは独立して使用可能
- エラーハンドリングを含める
- 動作確認方法も含める
- セキュリティ考慮事項も含める
- パフォーマンス最適化も考慮する
